<table id="allergy_list" class="light dense">
<%
if (reports && reports.length > 0) {
    var reports_sorted = _(reports).sortBy(function(r){
        if (typeof(r.item.dateDiagnosed) != 'undefined')
            return r.item.dateDiagnosed;
        else
            return '-99999';
    });
    
    var reports_reverse = reports_sorted.reverse();
    for (var i = 1; i <= reports_reverse.length; i++) {
        var report = reports_reverse[i-1]; %>
        <%= view('./views/allergy/item-dense', report) %>
    <% }
}
else { %>
    <tr><td colspan="3"><div class="attention">No reported allergies</div></td></tr>
<% } %>
</table>